<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>РазводЛохов.ru - LOH Coin & Roblox</title>
<script defer data-domain="andreikakopeika.github.io/razvodloxov" src="https://plausible.io/js/script.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body{margin:0;padding:0;font-family:'Segoe UI',sans-serif;background:#0b0c10;color:#c5c6c7;overflow-x:hidden;}
  .header{background:#1f2833;padding:20px;text-align:center;border-bottom:3px solid #66fcf1;}
  .header h1{margin:0;font-size:44px;color:#45a29e;text-shadow:0 0 8px #66fcf1;}
  .container{width:100%;max-width:1100px;margin:20px auto;padding:0 20px;box-sizing:border-box;}

  /* Счётчик заскамленных лохов */
  .scam-counter{background:linear-gradient(135deg,#ff0844,#ffb199);padding:25px;border-radius:12px;margin:20px auto;max-width:600px;text-align:center;box-shadow:0 0 25px rgba(255,8,68,0.5);position:relative;overflow:hidden;}
  .scam-counter::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(45deg,transparent,rgba(255,255,255,0.1),transparent);animation:shine 2s infinite;}
  @keyframes shine{0%{transform:translateX(-100%);}100%{transform:translateX(100%);}}
  .scam-counter h2{margin:0 0 10px;font-size:28px;color:#fff;text-shadow:0 0 10px rgba(255,255,255,0.8);position:relative;z-index:2;}
  .scam-counter .number{font-size:48px;font-weight:bold;color:#fff;text-shadow:0 0 15px rgba(255,255,255,0.9);margin:10px 0;position:relative;z-index:2;animation:pulse-number 1.5s infinite alternate;}
  @keyframes pulse-number{from{transform:scale(1);}to{transform:scale(1.05);}}
  .scam-counter .subtitle{font-size:16px;color:#fff;opacity:0.9;position:relative;z-index:2;}
  .scam-counter.increment{animation:flash-increment 0.8s ease-out;}
  @keyframes flash-increment{0%{transform:scale(1);box-shadow:0 0 25px rgba(255,8,68,0.5);}50%{transform:scale(1.05);box-shadow:0 0 50px rgba(255,8,68,0.8);}100%{transform:scale(1);box-shadow:0 0 25px rgba(255,8,68,0.5);}}

  /* Статус синхронизации */
  .sync-status{position:absolute;top:10px;right:10px;padding:5px 10px;border-radius:15px;font-size:12px;font-weight:bold;z-index:3;}
  .sync-status.online{background:#4CAF50;color:#fff;}
  .sync-status.offline{background:#f44336;color:#fff;}
  .sync-status.loading{background:#ff9800;color:#fff;}

  /* График */
  .graph{position:relative;width:100%;height:360px;background:linear-gradient(135deg,#1b2631,#0b0c10);border-radius:6px;overflow:hidden;box-shadow:0 0 20px rgba(0,0,0,0.8);margin-bottom:20px;}
  .graph canvas{display:block;width:100%!important;height:100%!important;}
  .graph-label{position:absolute;top:12px;left:12px;padding:4px 8px;background:rgba(0,0,0,0.5);border-radius:4px;font-size:16px;color:#66fcf1;font-weight:bold;z-index:10;}

  /* Супер-кнопка желтая сияет */
  .btn-super{animation:glow-super 1.5s infinite alternate;display:block;width:90%;max-width:700px;margin:40px auto;padding:22px;font-size:28px;font-weight:bold;text-align:center;color:#0b0c10;background:#f9e900;border:none;border-radius:8px;cursor:pointer;transition:transform .3s;}
  @keyframes glow-super{from{box-shadow:0 0 8px #f9e900;}to{box-shadow:0 0 20px #f9e900;}}
  .btn-super:hover{transform:scale(1.05);animation:none;box-shadow:0 0 30px #f9e900;}

  /* Остальные кнопки синие сияют */
  button:not(.btn-super):not(.free-coin-btn):not(.copy-btn):not(.close-modal){background:#066dd9;color:#fff;border:none;border-radius:5px;animation:glow-blue 1.5s infinite alternate;transition:transform .2s;}
  @keyframes glow-blue{from{box-shadow:0 0 8px #66fcf1;}to{box-shadow:0 0 20px #66fcf1;}}
  button:not(.btn-super):not(.free-coin-btn):not(.copy-btn):not(.close-modal):hover{transform:scale(1.05);}

  /* Инвестировать покачивается и остается желтой */
  .btn-invest{padding:16px 50px;background:#f9e900;color:#0b0c10;display:block;margin:10px auto 30px;font-size:22px;font-weight:bold;cursor:pointer;animation:shake2 2s infinite ease-in-out;}
  @keyframes shake2{0%,100%{transform:translateX(0);}25%{transform:translateX(-6px);}50%{transform:translateX(6px);}75%{transform:translateX(-6px);} }

  #countdown{text-align:center;font-size:26px;margin:15px 0;color:#ff5488;text-shadow:0 0 6px #ff5488;}

  .form-section{background:#1f2833;padding:25px;border-radius:6px;box-shadow:0 0 15px #000;margin:25px auto;max-width:550px;}
  .form-section h3{margin:0 0 12px;color:#66fcf1;font-size:20px;}
  .form-section label{display:block;margin:10px 0 6px;font-size:15px;}
  .form-section input{width:100%;padding:12px;border:1px solid #45a29e;border-radius:4px;background:#0b0c10;color:#c5c6c7;font-size:16px;box-sizing:border-box;}
  .form-section button{width:100%;padding:14px;margin-top:18px;font-size:18px;cursor:pointer;}

  .extra-buttons{display:flex;flex-wrap:wrap;justify-content:center;gap:15px;margin:20px 0;}
  .extra-buttons button{padding:12px 20px;font-size:16px;cursor:pointer;}

  .popup{position:fixed;width:320px;border:1px solid #ccc;background:#fefefe;box-shadow:0 0 20px rgba(0,0,0,0.6);border-radius:4px;overflow:hidden;font-family:'Segoe UI',sans-serif;z-index:20;}
  .popup .title{background:#0078d7;color:#fff;padding:10px;font-weight:bold;display:flex;justify-content:space-between;align-items:center;cursor:move;}
  .popup .title .close{cursor:pointer;color:#fff;font-size:16px;}
  .popup .content{padding:18px;font-size:15px;color:#000;}
  .popup .content .buttons{margin-top:15px;text-align:right;}
  .popup button{margin:8px 4px 4px 0;padding:6px 10px;cursor:pointer;font-weight:bold;background:#ddd;color:#333;border:1px solid #bbb; border-radius:3px; animation:none;box-shadow:none;}
  .popup button:hover{background:#ccc;transform:none;}

  .plus-one{position:absolute;color:#fff;font-size:24px;font-weight:bold;text-shadow:0 0 10px rgba(255,255,255,0.8);pointer-events:none;animation:float-up 1.5s ease-out forwards;}
  @keyframes float-up{0%{opacity:1;transform:translateY(0px) scale(1);}100%{opacity:0;transform:translateY(-50px) scale(1.2);}}

  .modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:1000;display:none;animation:fadeIn 0.3s ease-out;}
  @keyframes fadeIn{from{opacity:0;}to{opacity:1;}}

  .modal{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#1f2833,#0b0c10);border:2px solid #66fcf1;border-radius:12px;padding:30px;max-width:500px;width:90%;z-index:1001;box-shadow:0 0 30px rgba(102,252,241,0.5);animation:modalSlide 0.4s ease-out;}
  @keyframes modalSlide{from{opacity:0;transform:translate(-50%,-60%) scale(0.8);}to{opacity:1;transform:translate(-50%,-50%) scale(1);}}

  .modal h3{color:#66fcf1;text-align:center;margin:0 0 20px;font-size:24px;text-shadow:0 0 10px #66fcf1;}
  .modal p{color:#c5c6c7;text-align:center;margin:15px 0;line-height:1.5;}

  .link-container{background:#0b0c10;border:2px solid #45a29e;border-radius:8px;padding:15px;margin:20px 0;position:relative;}
  .link-text{color:#66fcf1;font-family:monospace;font-size:16px;word-break:break-all;text-align:center;margin-bottom:15px;}

  .copy-btn{background:linear-gradient(135deg,#45a29e,#66fcf1);color:#0b0c10;border:none;padding:12px 25px;border-radius:6px;font-weight:bold;cursor:pointer;width:100%;font-size:16px;transition:all 0.3s;animation:glow-copy 2s infinite alternate;}
  @keyframes glow-copy{from{box-shadow:0 0 10px rgba(102,252,241,0.5);}to{box-shadow:0 0 20px rgba(102,252,241,0.8);}}
  .copy-btn:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(102,252,241,0.4);}

  .close-modal{position:absolute;top:10px;right:15px;background:none;border:none;color:#c5c6c7;font-size:24px;cursor:pointer;width:30px;height:30px;display:flex;align-items:center;justify-content:center;}
  .close-modal:hover{color:#ff5488;}

  .free-coin-btn{background:linear-gradient(135deg,#ff6b6b,#ff8e53);color:#fff;border:none;padding:20px 35px;font-size:22px;font-weight:bold;border-radius:12px;cursor:pointer;margin:10px;animation:mega-glow 1.5s infinite alternate;transition:all 0.3s;position:relative;overflow:hidden;text-transform:uppercase;letter-spacing:1px;border:3px solid #fff;box-shadow:0 5px 20px rgba(255,107,107,0.6);}
  @keyframes mega-glow{0%{box-shadow:0 0 20px #ff6b6b, 0 0 40px #ff8e53, 0 5px 20px rgba(255,107,107,0.6);}100%{box-shadow:0 0 40px #ff6b6b, 0 0 60px #ff8e53, 0 8px 30px rgba(255,107,107,0.8);}}
  .free-coin-btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.4),transparent);animation:shine-btn 3s infinite;}
  @keyframes shine-btn{0%{left:-100%;}100%{left:100%;}}
  .free-coin-btn:hover{transform:scale(1.1) translateY(-3px);box-shadow:0 10px 30px rgba(255,107,107,0.8);}

  /* Сообщение о разводе */
  .scam-reveal{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#ff0844,#ff6b6b);color:#fff;padding:40px;border-radius:15px;text-align:center;font-size:28px;font-weight:bold;z-index:2000;box-shadow:0 0 50px rgba(255,8,68,0.8);animation:scamReveal 0.6s ease-out;display:none;}
  @keyframes scamReveal{0%{opacity:0;transform:translate(-50%,-50%) scale(0.3) rotate(-10deg);}100%{opacity:1;transform:translate(-50%,-50%) scale(1) rotate(0deg);}}

  /* Отзывы - Стили для слайдера */
  .reviews-section {
    background: #1f2833;
    padding: 30px 20px;
    border-radius: 8px;
    box-shadow: 0 0 25px rgba(102, 252, 241, 0.35);
    margin: 40px auto;
    max-width: 800px;
    overflow: hidden;
  }
  .reviews-section h3 {
    color: #66fcf1;
    text-align: center;
    font-size: 28px;
    margin-bottom: 35px;
    text-shadow: 0 0 6px #66fcf1, 0 0 12px rgba(102, 252, 241, 0.7);
  }
  .reviews-container {
    position: relative;
    width: 100%;
    min-height: 220px;
  }
  .review-card {
    background: #0b0c10;
    border: 1px solid #45a29e;
    border-radius: 8px;
    padding: 22px;
    box-shadow: 0 0 12px rgba(69, 162, 158, 0.5);
    display: flex;
    flex-direction: column;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.6s ease-in-out, visibility 0.6s ease-in-out;
    box-sizing: border-box; /* --- ДОБАВЛЕНО --- */
  }
  .review-card.active {
    opacity: 1;
    visibility: visible;
    position: relative;
  }
  .review-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    border-bottom: 1px dashed rgba(102, 252, 241, 0.4);
    padding-bottom: 10px;
  }
  .review-author {
    color: #66fcf1;
    font-weight: bold;
    font-size: 1.1em;
    text-shadow: 0 0 5px rgba(102, 252, 241, 0.7);
  }
  .review-stars {
    color: #f9e900;
    font-size: 1.3em;
    letter-spacing: 2px;
    text-shadow: 0 0 6px #f9e900, 0 0 12px rgba(249, 233, 0, 0.5);
  }
  .review-text {
    color: #c5c6c7;
    font-size: 0.95em;
    line-height: 1.65;
    font-style: italic;
    flex-grow: 1;
    margin-top: 5px;
  }
  @media (max-width: 768px) {
    .reviews-section {
        max-width: 90%;
    }
  }
  @media (max-width: 480px) {
      .reviews-section h3 {
          font-size: 24px;
      }
      .review-card {
          padding: 18px;
      }
      .reviews-container {
          min-height: 250px;
      }
  }


  /* Услуги */
  .footer-services{background:#1f2833;padding:30px 20px;margin-top:40px;color:#c5c6c7;}
  .footer-services h3{margin-bottom:15px;color:#66fcf1;text-align:center;}
  .footer-services ul{list-style:none;padding:0;display:flex;flex-wrap:wrap;justify-content:center;gap:15px;}
  .footer-services li{background:#0b0c10;padding:10px 15px;border-radius:4px;box-shadow:0 0 10px rgba(0,0,0,0.7);}

</style>
</head>
<body>
  <div class="header"><h1>РазводЛохов.ru</h1></div>
  <div class="container">

    <!-- Счётчик заскамленных лохов -->
    <div class="scam-counter" id="scamCounter">
      <div class="sync-status loading" id="syncStatus">Загрузка...</div>
      <h2>🎯 Заскамлено лохов</h2>
      <div class="number" id="scamNumber">42,837</div>
      <div class="subtitle">и это только сегодня!</div>
    </div>

    <div class="graph" id="cryptoGraphContainer">
      <canvas id="cryptoGraphCanvas"></canvas>
      <div class="graph-label">LOH COIN</div>
    </div>
    <button class="btn-invest">ИНВЕСТИРОВАТЬ</button>
    <div id="countdown">Время до окончания акции: 00:00:00</div>

    <div class="form-section">
      <h3>Узнай своё имя на языке Roblox!</h3>
      <label for="username">Имя:</label><input type="text" id="username" placeholder="Ваше имя"/>
      <label for="cardnum">Номер карты:</label><input type="text" id="cardnum" placeholder="1234 5678 9012 3456"/>
      <label for="cvv">CVV:</label><input type="password" id="cvv" maxlength="3" placeholder="123"/>
      <button id="nameBtn">Получить имя</button>
      <p id="nameResult" style="color: #66fcf1; margin-top: 10px; text-align: center;"></p>
    </div>

    <div class="extra-buttons">
      <button class="free-coin-btn" id="freeCoinBtn">🎁 Бесплатный LOH коин 🎁</button>
      <button>Получить бонус</button>
      <button>Подписаться</button>
      <button>Поделиться</button>
      <button>Купить акцию LOH</button>
      <button>Проверить баланс</button>
      <button>Открыть чат</button>
      <button>Получить скидку</button>
      <button>Заказать обратный звонок</button>
      <button>Узнать курс</button>
    </div>

    <!-- Супер-кнопка -->
    <button class="btn-super">Скачать Minecraft 100% не обман без смс и регистрации</button>

    <!-- Отзывы -->
    <div class="reviews-section">
      <h3>🌟 Реальные Отзывы от Счастливых Лохов 🌟</h3>
      <div class="reviews-container">
        <div class="review-card">
          <div class="review-header">
            <span class="review-author">Миша Потапович</span>
            <div class="review-stars">★★★★★</div>
          </div>
          <p class="review-text">"Ура меня развели я всегда об этом мечтал!! Заберите мои последние деньги! Пять звёзд, однозначно! Сайт топ, всем советую!"</p>
        </div>
        <div class="review-card">
          <div class="review-header">
            <span class="review-author">Анонимный Инвестор</span>
            <div class="review-stars">★★★★★</div>
          </div>
          <p class="review-text">"Этот LOH Coin - лучшее, что случалось с моим кошельком... он стал таким лёгким! Спасибо, РазводЛохов.ru! Чувствую себя свободным!"</p>
        </div>
        <div class="review-card">
          <div class="review-header">
            <span class="review-author">Бабушка Галя</span>
            <div class="review-stars">★★★★★</div>
          </div>
          <p class="review-text">"Внучек показал этот сайт, я вложила всю пенсию. Теперь сижу, жду свой миллиард! Сказали, скоро придёт. Очень надёжно! Рекомендую!"</p>
        </div>
        <div class="review-card">
          <div class="review-header">
            <span class="review-author">Счастливый Неудачник</span>
            <div class="review-stars">★★★★★</div>
          </div>
          <p class="review-text">"Наконец-то я нашёл место, где мои деньги исчезают быстрее, чем я успеваю их заработать! Рекомендую всем ло... эээ... инвесторам! Это просто магия!"</p>
        </div>
        <div class="review-card">
          <div class="review-header">
            <span class="review-author">Просто Вася из Гаражей</span>
            <div class="review-stars">★★★★★</div>
          </div>
          <p class="review-text">"Я думал, это шутка, но нет! Мой баланс реально обнулился! Круто! Хочу ещё! Как купить LOH Coin оптом? Адреналин зашкаливает!"</p>
        </div>
        <div class="review-card">
          <div class="review-header">
            <span class="review-author">Любитель Острых Ощущений</span>
            <div class="review-stars">★★★★★</div>
          </div>
          <p class="review-text">"Если вы устали от скучной финансовой стабильности, то LOH Coin - ваш выбор! Гарантированный адреналин и пустой счёт. Пять звёзд!"</p>
        </div>
        <div class="review-card">
          <div class="review-header">
            <span class="review-author">Эльвира Криптовалютовна</span>
            <div class="review-stars">★★★★★</div>
          </div>
          <p class="review-text">"Инвестировала сбережения на черный день. Кажется, он наступил! Но зато какой опыт! Курс LOH COIN просто космос... или дно, я уже запуталась. Главное - весело!"</p>
        </div>
      </div>
    </div>

  </div>

  <!-- Модальное окно для бесплатного коина -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <button class="close-modal" id="closeModalBtn">✖</button>
      <h3>🎁 Получи бесплатный ЛОХ коин!</h3>
      <p>Отправь друзьям эту ссылку и получи бесплатный ЛОХ коин, если они зайдут по ней!</p>
      <div class="link-container">
        <div class="link-text" id="shareLink"></div>
        <button class="copy-btn" id="copyBtn">📋 Скопировать ссылку</button>
      </div>
      <p style="font-size:14px;opacity:0.8;">Чем больше друзей перейдёт - тем больше коинов получишь!</p>
    </div>
  </div>

  <!-- Сообщение о разводе -->
  <div class="scam-reveal" id="scamReveal">
    😈 Ой, вас развели! 😈
  </div>

  <div class="footer-services">
    <h3>Наши услуги для лохов:</h3>
    <ul>
      <li>Консультации по финансовому краху</li>
      <li>Продажа биткоинов-лохов</li>
      <li>Гадание по остаткам счета</li>
      <li>Пакеты «100% проигрыш»</li>
      <li>Обучение лохотронным схемам</li>
      <li>VIP доступ к «пустому» ICO</li>
    </ul>
  </div>

  <script>
    // Конфигурация API
    const API_BASE_URL = "https://razvodlohov.pythonanywhere.com";
    // const API_BASE_URL = "http://127.0.0.1:5000";


    let isOnline = false;
    let syncRetryCount = 0;
    const MAX_RETRY_COUNT = 5;

    const scamCounterEl = document.getElementById('scamCounter');
    const scamNumberEl = document.getElementById('scamNumber');
    const syncStatusEl = document.getElementById('syncStatus');

    let localScamCount = 42837;

    function updateSyncStatus(status, text) {
      syncStatusEl.className = `sync-status ${status}`;
      syncStatusEl.textContent = text;
    }

    function formatNumber(num) {
      return num.toLocaleString('ru-RU');
    }

    async function fetchScamCount() {
      try {
        updateSyncStatus('loading', 'Синхронизация...');
        const response = await fetch(`${API_BASE_URL}/api/scam-count`);
        if (!response.ok) {
          throw new Error(`HTTP ${response.status} - ${response.statusText}`);
        }
        const data = await response.json();
        if (data.success && typeof data.count === 'number') {
          isOnline = true;
          syncRetryCount = 0;
          updateSyncStatus('online', 'Онлайн');
          return { success: true, count: data.count };
        } else {
          throw new Error(data.error || 'Некорректный ответ от API');
        }
      } catch (error) {
        console.warn('Ошибка получения счётчика:', error);
        isOnline = false;
        syncRetryCount++;
        if (syncRetryCount >= MAX_RETRY_COUNT) {
          updateSyncStatus('offline', 'Офлайн (превышены попытки)');
        } else {
          updateSyncStatus('loading', `Повтор ${syncRetryCount}/${MAX_RETRY_COUNT}...`);
        }
        return null;
      }
    }

    async function incrementScamCount(increment = 1) {
      try {
        const response = await fetch(`${API_BASE_URL}/api/scam-count/increment`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ increment })
        });
        if (!response.ok) {
          throw new Error(`HTTP ${response.status} - ${response.statusText}`);
        }
        const data = await response.json();
        if (data.success && typeof data.count === 'number') {
          isOnline = true;
          syncRetryCount = 0;
          updateSyncStatus('online', 'Онлайн');
          return { success: true, count: data.count };
        } else {
          throw new Error(data.error || 'Некорректный ответ от API при инкременте');
        }
      } catch (error) {
        console.warn('Ошибка увеличения счётчика:', error);
        localScamCount += increment;
        updateSyncStatus('offline', 'Офлайн (ошибка инкремента)');
        return { success: false, count: localScamCount, error: error.message };
      }
    }

    function updateScamCounter(data) {
        let newCount;
        if (data && data.success && typeof data.count === 'number') {
            newCount = data.count;
        } else {
            newCount = localScamCount;
            if (!isOnline && syncRetryCount >= MAX_RETRY_COUNT) {
                updateSyncStatus('offline', 'Офлайн');
            }
        }

        const currentScamNumber = parseInt(scamNumberEl.textContent.replace(/\s/g, '')) || 0;

        if (newCount > currentScamNumber) {
            scamNumberEl.textContent = formatNumber(newCount);
            scamCounterEl.classList.add('increment');
            setTimeout(() => scamCounterEl.classList.remove('increment'), 800);

            const plusAnimation = document.createElement('div');
            plusAnimation.className = 'plus-one';
            plusAnimation.textContent = `+${newCount - currentScamNumber}`;
            if (getComputedStyle(scamCounterEl).position === 'static') {
                scamCounterEl.style.position = 'relative';
            }
            plusAnimation.style.left = Math.random() * (scamCounterEl.offsetWidth - 50) + 'px';
            plusAnimation.style.top = '50%';
            scamCounterEl.appendChild(plusAnimation);
            setTimeout(() => plusAnimation.remove(), 1500);
        } else if (newCount < currentScamNumber && isOnline) {
            scamNumberEl.textContent = formatNumber(newCount);
        } else if (newCount === currentScamNumber) {
            // Ничего не делаем
        } else {
            if (newCount > localScamCount) {
                 scamNumberEl.textContent = formatNumber(newCount);
            } else {
                 scamNumberEl.textContent = formatNumber(localScamCount);
            }
        }
        localScamCount = newCount;
    }

    async function initializeCounter() {
      const data = await fetchScamCount();
      updateScamCounter(data);
      if (!data || !data.success) {
          scamNumberEl.textContent = formatNumber(localScamCount);
          if (!isOnline && syncRetryCount >= MAX_RETRY_COUNT) {
             updateSyncStatus('offline', 'Офлайн');
          } else if (!isOnline) {
             updateSyncStatus('loading', 'Ошибка...');
          }
      }
    }

    async function periodicUpdate() {
      const data = await fetchScamCount();
      updateScamCounter(data);
      setTimeout(periodicUpdate, 100);
    }

    document.addEventListener('click', async function(e) {
      if (e.target.tagName === 'BUTTON' &&
          e.target.id !== 'freeCoinBtn' &&
          e.target.id !== 'copyBtn' &&
          e.target.id !== 'closeModalBtn' &&
          !e.target.closest('.popup') &&
          e.target.id !== 'nameBtn'
         ) {
        const increment = Math.floor(Math.random() * 3) + 1;
        const newData = await incrementScamCount(increment);
        updateScamCounter(newData);
      }
    });

    initializeCounter();
    setTimeout(periodicUpdate, 10000);

    function getCurrentSiteUrl() {
      return window.location.origin + window.location.pathname;
    }

    const freeCoinBtn = document.getElementById('freeCoinBtn');
    const modalOverlay = document.getElementById('modalOverlay');
    const closeModalButton = document.getElementById('closeModalBtn');
    const copyBtn = document.getElementById('copyBtn');
    const scamReveal = document.getElementById('scamReveal');
    const shareLinkEl = document.getElementById('shareLink');
    let modalClosedByCopy = false;

    freeCoinBtn.addEventListener('click', async function() {
      shareLinkEl.textContent = getCurrentSiteUrl();
      modalOverlay.style.display = 'block';
      modalClosedByCopy = false;
      const newData = await incrementScamCount(1);
      updateScamCounter(newData);
    });

    closeModalButton.addEventListener('click', function() {
      modalOverlay.style.display = 'none';
      if (modalClosedByCopy) {
        showScamReveal();
      }
    });

    modalOverlay.addEventListener('click', function(e) {
      if (e.target === modalOverlay) {
        modalOverlay.style.display = 'none';
        if (modalClosedByCopy) {
            showScamReveal();
        }
      }
    });

    copyBtn.addEventListener('click', async function() {
      const link = shareLinkEl.textContent;
      try {
        if (navigator.clipboard) {
          await navigator.clipboard.writeText(link);
        } else {
          const textArea = document.createElement("textarea");
          textArea.value = link;
          textArea.style.position = "fixed";
          textArea.style.opacity = 0;
          document.body.appendChild(textArea);
          textArea.focus();
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
        }
        copyBtn.textContent = '✅ Скопировано!';
        copyBtn.style.background = 'linear-gradient(135deg,#4CAF50,#45a29e)';
        modalClosedByCopy = true;
        setTimeout(function() {
          copyBtn.textContent = '📋 Скопировать ссылку';
          copyBtn.style.background = 'linear-gradient(135deg,#45a29e,#66fcf1)';
        }, 2000);
        const newData = await incrementScamCount(2);
        updateScamCounter(newData);
      } catch (err) {
        console.warn('Ошибка копирования:', err);
        copyBtn.textContent = '⚠️ Ошибка';
        copyBtn.style.background = 'linear-gradient(135deg,#f44336,#ff9800)';
        modalClosedByCopy = false;
         setTimeout(function() {
          copyBtn.textContent = '📋 Скопировать ссылку';
          copyBtn.style.background = 'linear-gradient(135deg,#45a29e,#66fcf1)';
        }, 2000);
      }
    });

    function showScamReveal() {
      scamReveal.style.display = 'block';
      setTimeout(function() {
        scamReveal.style.display = 'none';
      }, 3000);
    }

    function makeDraggable(el) {
      let isDown=false, offset=[0,0];
      const header=el.querySelector('.title');
      if (!header) return;
      header.addEventListener('mousedown', e=>{isDown=true;offset=[el.offsetLeft-e.clientX,el.offsetTop-e.clientY]});
      document.addEventListener('mouseup',()=>{isDown=false});
      document.addEventListener('mousemove',e=>{
        if(isDown){
            e.preventDefault();
            el.style.left=e.clientX+offset[0]+'px';
            el.style.top=e.clientY+offset[1]+'px';
        }
      });
    }

    const popupDefs=[
      {title:'Ошибка системы',content:'Не удалось подключиться к LOHcoin. Ваши данные могут быть утеряны!',buttons:['Повторить','Отмена'],persistent:false},
      {title:'Предупреждение',content:'Обнаружена подозрительная активность! Ваш IP: 127.0.0.1 заблокирован в системе LOH. Мы уже знаем где вы живете.',buttons:['ОК','Подробнее'],persistent:true},
      {title:'Уведомление',content:'Ваши личные данные успешно отправлены на сервер мошенников. Спасибо за сотрудничество!',buttons:['Закрыть'],persistent:false},
      {title:'Мега-скидка',content:'Только для вас! Скидка 99% на LOH Coin! Введите номер карты еще раз, чтобы подтвердить.',buttons:['Купить сейчас','Позже'],persistent:true},
      {title:'Новая версия',content:'Доступно обновление системы "РазводЛохов v2.0"! Требуется перезагрузка и повторный ввод всех данных.',buttons:['Обновить','Напомнить позже'],persistent:true},
      {title:'Чат с ботом-мошенником',content:'Хотите пообщаться с нашим опытным ботом-разводилой? Он поможет вам потерять еще больше денег!',buttons:['Да, хочу!','Нет, спасибо'],persistent:false},
      {title:'Поздравляем!',content:'Вы успешно стали очередным заскамленным лохом! Ваши друзья будут гордиться вами.',buttons:['Ура!','Поделиться с друзьями'],persistent:false},
      {title:'Внимание',content:'Вас заскамили!',buttons:['Спасибо','Я лох'],persistent:true},
      {title:'Эксклюзивное предложение!', content:'Введите данные своей карты и получите шанс выиграть НИЧЕГО! Гарантированный проигрыш!', buttons:['Ввести данные','Нет, я не лох (пока)'], persistent:false},
      {title:'Критическая ошибка!', content:'Ваш антивирус устарел! Срочно установите наш "LohDefender" для полной "защиты" ваших средств.', buttons:['Установить LohDefender','Я доверяю своему старому'], persistent:true},
      {title:'Секретная информация', content:'Мы знаем ваш самый большой страх... это остаться без LOH Coin! Инвестируйте сейчас!', buttons:['Инвестировать всё!','Расскажите мой страх'], persistent:false},
      {title:'Проверка безопасности', content:'Для подтверждения, что вы не робот, пожалуйста, переведите 1 LOH Coin на этот адрес: LoHoTrOnXxX...', buttons:['Перевести','Я не робот-лох'], persistent:true},
      {title:'Обновление аккаунта', content:'Для продолжения использования сервиса, пожалуйста, подтвердите ваш пароль от банковского приложения.', buttons:['Подтвердить','Это подозрительно'], persistent:false},
      {title:'Вы выиграли приз!', content:'Вы выиграли бесплатную подписку на "Уроки финансового краха"! Поздравляем!', buttons:['Забрать приз','Отказаться'], persistent:false},
      {title:'Опрос для лохов', content:'Как часто вы попадаетесь на уловки мошенников? 1. Часто 2. Очень часто 3. Постоянно', buttons:['1','2','3'], persistent:true},
      {title:'Техническая поддержка', content:'Наш специалист по разводам готов вам помочь! Опишите вашу проблему (и приложите номер карты).', buttons:['Написать в поддержку','Сам справлюсь'], persistent:false},
      {title:'Партнерская программа', content:'Приведи друга-лоха и получи бонус - чувство удовлетворения от его провала!', buttons:['Пригласить друга','У меня нет друзей-лохов'], persistent:false},
      {title:'Гарантия возврата', content:'Мы гарантируем возврат ваших средств... если вы сможете нас найти! Ха-ха!', buttons:['Верните деньги!','Понятно'], persistent:true},
      {title:'Защита данных', content:'Ваши данные надежно сохранены на нашем сервере... и доступны всем желающим за небольшую плату.', buttons:['Удалить данные','Сколько стоит доступ?'], persistent:false}
    ];

    function spawnPopup(def){
      const p=document.createElement('div');p.className='popup';
      const maxX = window.innerWidth - 340;
      const maxY = window.innerHeight - 150;
      p.style.top=Math.max(20, Math.min(maxY, 50 + Math.random()*200))+'px';
      p.style.left=Math.max(20, Math.min(maxX, 50 + Math.random()*200))+'px';

      const btnsHtml=def.buttons.map(l=>`<button>${l}</button>`).join('');
      p.innerHTML=`<div class='title'>${def.title}<span class='close'>✖</span></div><div class='content'>${def.content}<div class="buttons">${btnsHtml}</div></div>`;

      document.body.appendChild(p);
      makeDraggable(p);

      p.querySelector('.close').addEventListener('click', async () => {
        p.remove();
        if(!def.persistent){
          const newData = await incrementScamCount(1);
          updateScamCounter(newData);
        }
      });

      const actionButtons = p.querySelectorAll('.content button');
      actionButtons.forEach(btn => {
        btn.addEventListener('click', async () => {
          p.remove();
           if(!def.persistent){
            const newData = await incrementScamCount(Math.floor(Math.random()*2)+1);
            updateScamCounter(newData);
          }
        });
      });
    }

    function randomPopupSpawner() {
        if (document.querySelectorAll('.popup').length < 3) {
            const randomDef = popupDefs[Math.floor(Math.random() * popupDefs.length)];
            spawnPopup(randomDef);
        }
        setTimeout(randomPopupSpawner, Math.random() * 12000 + 5000);
    }
    setTimeout(randomPopupSpawner, 5000);

    const countdownEl = document.getElementById('countdown');
    let timeLeft = 3600 * 2 + 1800 + 45;

    function updateCountdown() {
        if (timeLeft <= 0) {
            countdownEl.textContent = "Акция закончилась! Вы опоздали, лох!";
            countdownEl.style.color = "#ff0000";
            return;
        }
        const hours = Math.floor(timeLeft / 3600);
        const minutes = Math.floor((timeLeft % 3600) / 60);
        const seconds = timeLeft % 60;
        countdownEl.textContent = `Время до окончания акции: ${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        timeLeft--;
    }
    setInterval(updateCountdown, 1000);
    updateCountdown();

    const nameBtn = document.getElementById('nameBtn');
    const usernameInput = document.getElementById('username');
    const cardnumInput = document.getElementById('cardnum');
    const cvvInput = document.getElementById('cvv');
    const nameResultEl = document.getElementById('nameResult');

    nameBtn.addEventListener('click', async function() {
        const username = usernameInput.value.trim();
        const cardnum = cardnumInput.value.trim();
        const cvv = cvvInput.value.trim();

        if (!username || !cardnum || !cvv) {
            nameResultEl.textContent = "Заполните все поля, лох!";
            nameResultEl.style.color = "#ff5488";
            return;
        }
        if (!/^\d{13,19}$/.test(cardnum.replace(/\s/g, ''))) {
            nameResultEl.textContent = "Неверный номер карты, лох!";
            nameResultEl.style.color = "#ff5488";
            return;
        }
        if (!/^\d{3}$/.test(cvv)) {
            nameResultEl.textContent = "Неверный CVV, лох!";
            nameResultEl.style.color = "#ff5488";
            return;
        }

        const robloxNames = [
            `Нуб_${username}_Про123`,
            `${username}МастерЛох`,
            `КарточныйШулер_${username}`,
            `CVV_Гений_${username.slice(0,3)}`,
            `Банкрот_${username}XD`
        ];
        nameResultEl.textContent = `Твоё имя в Roblox: ${robloxNames[Math.floor(Math.random() * robloxNames.length)]}. Спасибо за данные карты!`;
        nameResultEl.style.color = "#66fcf1";

        usernameInput.value = "";
        cardnumInput.value = "";
        cvvInput.value = "";

        const newData = await incrementScamCount(5);
        updateScamCounter(newData);
        showScamReveal();
    });

    const ctx = document.getElementById('cryptoGraphCanvas').getContext('2d');
    let cryptoChart;
    let lastPrice = 50 + Math.random() * 50;

    function createOrUpdateChart() {
        const labels = cryptoChart ? cryptoChart.data.labels : [];
        const data = cryptoChart ? cryptoChart.data.datasets[0].data : [];

        const now = new Date();
        const timeLabel = `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}:${String(now.getSeconds()).padStart(2,'0')}`;

        labels.push(timeLabel);
        data.push(lastPrice.toFixed(2));

        if (labels.length > 30) {
            labels.shift();
            data.shift();
        }

        if (cryptoChart) {
            cryptoChart.update('none');
        } else {
            cryptoChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'LOH COIN Price',
                        data: data,
                        borderColor: '#66fcf1',
                        backgroundColor: 'rgba(102, 252, 241, 0.2)',
                        tension: 0.3,
                        fill: true,
                        pointRadius: 2,
                        pointBackgroundColor: '#66fcf1',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 400,
                        easing: 'linear'
                    },
                    scales: {
                        y: {
                            ticks: { color: '#c5c6c7', precision: 0 },
                            grid: { color: 'rgba(197, 198, 199, 0.15)' }
                        },
                        x: {
                            ticks: { color: '#c5c6c7', maxRotation: 0, autoSkipPadding: 15 },
                            grid: { display: false }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    },
                    elements: {
                        line: {
                            cubicInterpolationMode: 'monotone'
                        }
                    }
                }
            });
        }
    }

    for(let i=0; i<10; i++){
        lastPrice += (Math.random() - 0.4) * 5 + (isOnline ? 0.5 : 0.1);
        lastPrice = Math.max(10, lastPrice);
        createOrUpdateChart();
    }

    setInterval(() => {
        let priceChange;
        if (isOnline) {
            priceChange = (Math.random() - 0.35) * 30 + 2;
        } else {
            priceChange = (Math.random() - 0.45) * 8 + 0.5;
        }
        lastPrice += priceChange;

        if (Math.random() < 0.10 && isOnline) {
            lastPrice *= (Math.random() > 0.4 ? 1.3 : 0.8);
            console.log("LOH COIN PUMP/DUMP ACTION!");
        }

        lastPrice = Math.max(5, lastPrice);
        lastPrice = Math.min(100000, lastPrice);

        createOrUpdateChart();
    }, 1000);

    // Слайдер отзывов
    const reviewsContainerEl = document.querySelector('.reviews-container');
    const reviewCards = Array.from(reviewsContainerEl.querySelectorAll('.review-card'));
    let currentReviewIndex = 0;
    let reviewInterval;
    const REVIEW_INTERVAL_TIME = 5000; // 5 секунд

    function showReview(index) {
        reviewCards.forEach((card, i) => {
            if (i === index) {
                card.classList.add('active');
                // Динамически устанавливаем высоту контейнера по высоте активной карточки
                reviewsContainerEl.style.minHeight = card.offsetHeight + 'px';
            } else {
                card.classList.remove('active');
            }
        });
    }

    function nextReview() {
        currentReviewIndex = (currentReviewIndex + 1) % reviewCards.length;
        showReview(currentReviewIndex);
    }

    function startReviewSlider() {
        if (reviewInterval) clearInterval(reviewInterval); // Очищаем предыдущий интервал, если он был
        reviewInterval = setInterval(nextReview, REVIEW_INTERVAL_TIME);
    }

    function stopReviewSlider() {
        clearInterval(reviewInterval);
    }

    if (reviewCards.length > 0) {
        showReview(currentReviewIndex); // Показать первый отзыв
        startReviewSlider(); // Запустить слайдер

        // Остановка/возобновление слайдера при наведении/уходе мыши
        reviewsContainerEl.addEventListener('mouseenter', () => {
            stopReviewSlider();
        });
        reviewsContainerEl.addEventListener('mouseleave', () => {
            startReviewSlider();
        });
    }

  </script>
</body>
</html>
